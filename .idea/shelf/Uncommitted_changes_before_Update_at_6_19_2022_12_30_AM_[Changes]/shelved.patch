Index: main.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from functools import wraps\r\nfrom flask import abort, render_template, redirect, url_for, flash\r\nfrom datetime import date\r\nfrom werkzeug.security import generate_password_hash, check_password_hash\r\nfrom flask_login import login_user, login_required, current_user, logout_user\r\nfrom MyBlog.forms import CreatePostForm, RegisterForm, LoginForm, CommentForm\r\nfrom app import app\r\nfrom model import db, BlogPost, User, Comment\r\n\r\n\r\n\r\n@app.route('/')\r\ndef get_all_posts():\r\n    posts = BlogPost.query.all()\r\n    return render_template(\"index.html\", all_posts=posts)\r\n\r\ndef hash_string(password):\r\n    return generate_password_hash(password, method='pbkdf2:sha256', salt_length=8)\r\n\r\n#\r\ndef admin_only(f):\r\n    @wraps(f)\r\n    def decorated_function(*args, **kwargs):\r\n        #If id is not 1 then return abort with 403 error\r\n        if current_user.id != 1:\r\n            return abort(403)\r\n        #Otherwise continue with the route function\r\n        return f(*args, **kwargs)\r\n    return decorated_function\r\n\r\n\r\n@app.route('/register', methods=['POST', 'GET'])\r\ndef register():\r\n    register_form = RegisterForm()\r\n    if register_form.validate_on_submit():\r\n        new_user = User(\r\n            name=register_form.name.data,\r\n            email=register_form.email.data,\r\n            password=hash_string(register_form.password.data)\r\n        )\r\n\r\n        if User.query.filter_by(email=new_user.email).first():\r\n            flash(\"Email already exist. Proceed to login\")\r\n            return redirect(url_for('login'))\r\n        else:\r\n            db.session.add(new_user)\r\n            db.session.commit()\r\n            login_user(new_user)\r\n            return redirect(url_for('get_all_posts', user=new_user))\r\n\r\n    return render_template(\"register.html\", form=register_form)\r\n\r\n\r\n@app.route('/login', methods=['POST', 'GET'])\r\ndef login():\r\n    login_form = LoginForm()\r\n\r\n    if login_form.validate_on_submit():\r\n        email=login_form.email.data\r\n        password=login_form.password.data\r\n\r\n        logging_user = User.query.filter_by(email=email).first()\r\n\r\n        if logging_user:\r\n            if check_password_hash(logging_user.password, password):\r\n                login_user(logging_user)\r\n                return redirect(url_for('get_all_posts'))\r\n            else:\r\n                flash(\"User if of password is wrong.\")\r\n                return redirect(url_for('register'))\r\n        else:\r\n            flash(\"User email is not registered please register to login.\")\r\n\r\n    return render_template(\"login.html\", form=login_form)\r\n\r\n\r\n@app.route('/logout')\r\n@login_required\r\ndef logout():\r\n    logout_user()\r\n    return redirect(url_for('get_all_posts'))\r\n\r\n\r\n@app.route(\"/post/<int:post_id>\", methods=['POST', 'GET'])\r\ndef show_post(post_id):\r\n    requested_post = BlogPost.query.get(post_id)\r\n    comment_form = CommentForm()\r\n\r\n    if comment_form.validate_on_submit():\r\n        # save comments\r\n        if current_user.is_authenticated:\r\n            comment = Comment(\r\n                post_id=post_id,\r\n                comment=comment_form.comment.data,\r\n                user_id=current_user.id\r\n            )\r\n            db.session.add(comment)\r\n            db.session.commit()\r\n            print(\"This is commit\")\r\n        else:\r\n            return redirect(url_for('login'))\r\n    return render_template(\"post.html\", post=requested_post, form=comment_form)\r\n\r\n\r\n@app.route(\"/about\")\r\ndef about():\r\n    return render_template(\"about.html\")\r\n\r\n\r\n@app.route(\"/contact\")\r\ndef contact():\r\n    return render_template(\"contact.html\")\r\n\r\n\r\n@app.route(\"/new-post\", methods=['POST', 'get'])\r\n@login_required\r\n@admin_only\r\ndef add_new_post():\r\n    form = CreatePostForm()\r\n    if form.validate_on_submit():\r\n        new_post = BlogPost(\r\n            title=form.title.data,\r\n            subtitle=form.subtitle.data,\r\n            body=form.body.data,\r\n            img_url=form.img_url.data,\r\n            author=current_user,\r\n            date=date.today().strftime(\"%B %d, %Y\")\r\n        )\r\n        db.session.add(new_post)\r\n        db.session.commit()\r\n        return redirect(url_for(\"get_all_posts\"))\r\n    return render_template(\"make-post.html\", form=form)\r\n\r\n\r\n@app.route(\"/edit-post/<int:post_id>\")\r\n@admin_only\r\ndef edit_post(post_id):\r\n    post = BlogPost.query.get(post_id)\r\n    edit_form = CreatePostForm(\r\n        title=post.title,\r\n        subtitle=post.subtitle,\r\n        img_url=post.img_url,\r\n        author=post.author,\r\n        body=post.body\r\n    )\r\n    if edit_form.validate_on_submit():\r\n        post.title = edit_form.title.data\r\n        post.subtitle = edit_form.subtitle.data\r\n        post.img_url = edit_form.img_url.data\r\n        post.author = edit_form.author.data\r\n        post.body = edit_form.body.data\r\n        db.session.commit()\r\n        return redirect(url_for(\"show_post\", post_id=post.id))\r\n\r\n    return render_template(\"make-post.html\", form=edit_form)\r\n\r\n\r\n@app.route(\"/delete/<int:post_id>\")\r\n@login_required\r\n@admin_only\r\ndef delete_post(post_id):\r\n    post_to_delete = BlogPost.query.get(post_id)\r\n    db.session.delete(post_to_delete)\r\n    db.session.commit()\r\n    return redirect(url_for('get_all_posts'))\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    app.run(host='127.0.0.1', port=5000, debug=True)\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main.py b/main.py
--- a/main.py	(revision 498f31eb08934d0124b977673945a265eedbdf9e)
+++ b/main.py	(date 1655587790280)
@@ -3,7 +3,7 @@
 from datetime import date
 from werkzeug.security import generate_password_hash, check_password_hash
 from flask_login import login_user, login_required, current_user, logout_user
-from MyBlog.forms import CreatePostForm, RegisterForm, LoginForm, CommentForm
+from forms import CreatePostForm, RegisterForm, LoginForm, CommentForm
 from app import app
 from model import db, BlogPost, User, Comment
 
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"408a33fc-514c-4f9c-b12a-a0bb1a9e9ae5\" name=\"Changes\" comment=\"initial working version\" />\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"ChangesViewManager\">\r\n    <option name=\"groupingKeys\">\r\n      <option value=\"directory\" />\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n  </component>\r\n  <component name=\"ProjectId\" id=\"2AW9XUEgG5IZVoBPWMjAJStZ4f4\" />\r\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\" />\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n    <option name=\"showMembers\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">\r\n    <property name=\"ChangesTree.GroupingKeys\" value=\"\" />\r\n    <property name=\"RunOnceActivity.OpenProjectViewOnStart\" value=\"true\" />\r\n    <property name=\"RunOnceActivity.ShowReadmeOnStart\" value=\"true\" />\r\n    <property name=\"last_opened_file_path\" value=\"$PROJECT_DIR$\" />\r\n    <property name=\"settings.editor.selected.configurable\" value=\"com.jetbrains.python.configuration.PyActiveSdkModuleConfigurable\" />\r\n  </component>\r\n  <component name=\"RecentsManager\">\r\n    <key name=\"CopyFile.RECENT_KEYS\">\r\n      <recent name=\"D:\\Projects\\PyCharmProjects\\day69-blog-with-users\" />\r\n    </key>\r\n    <key name=\"MoveFile.RECENT_KEYS\">\r\n      <recent name=\"D:\\Projects\\PyCharmProjects\\day69-blog-with-users\\MyBlog\" />\r\n    </key>\r\n  </component>\r\n  <component name=\"RunManager\" selected=\"Python.main\">\r\n    <configuration name=\"login-module\" type=\"PythonConfigurationType\" factoryName=\"Python\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <module name=\"day67-RESTful-blog-start\" />\r\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\r\n      <option name=\"PARENT_ENVS\" value=\"true\" />\r\n      <envs>\r\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\r\n      </envs>\r\n      <option name=\"SDK_HOME\" value=\"\" />\r\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$\" />\r\n      <option name=\"IS_MODULE_SDK\" value=\"true\" />\r\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\r\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\r\n      <option name=\"SCRIPT_NAME\" value=\"$PROJECT_DIR$/login-module.py\" />\r\n      <option name=\"PARAMETERS\" value=\"\" />\r\n      <option name=\"SHOW_COMMAND_LINE\" value=\"false\" />\r\n      <option name=\"EMULATE_TERMINAL\" value=\"false\" />\r\n      <option name=\"MODULE_MODE\" value=\"false\" />\r\n      <option name=\"REDIRECT_INPUT\" value=\"false\" />\r\n      <option name=\"INPUT_FILE\" value=\"\" />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <configuration name=\"main\" type=\"PythonConfigurationType\" factoryName=\"Python\" nameIsGenerated=\"true\">\r\n      <module name=\"day67-RESTful-blog-start\" />\r\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\r\n      <option name=\"PARENT_ENVS\" value=\"true\" />\r\n      <envs>\r\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\r\n      </envs>\r\n      <option name=\"SDK_HOME\" value=\"D:\\Projects\\PyCharmProjects\\day67-RESTful-blog-start\\venv\\Scripts\\python.exe\" />\r\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$\" />\r\n      <option name=\"IS_MODULE_SDK\" value=\"false\" />\r\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\r\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\r\n      <option name=\"SCRIPT_NAME\" value=\"D:\\Projects\\PyCharmProjects\\day69-blog-with-users\\MyBlog\\main.py\" />\r\n      <option name=\"PARAMETERS\" value=\"\" />\r\n      <option name=\"SHOW_COMMAND_LINE\" value=\"false\" />\r\n      <option name=\"EMULATE_TERMINAL\" value=\"false\" />\r\n      <option name=\"MODULE_MODE\" value=\"false\" />\r\n      <option name=\"REDIRECT_INPUT\" value=\"false\" />\r\n      <option name=\"INPUT_FILE\" value=\"\" />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <configuration name=\"model\" type=\"PythonConfigurationType\" factoryName=\"Python\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <module name=\"day67-RESTful-blog-start\" />\r\n      <option name=\"INTERPRETER_OPTIONS\" value=\"\" />\r\n      <option name=\"PARENT_ENVS\" value=\"true\" />\r\n      <envs>\r\n        <env name=\"PYTHONUNBUFFERED\" value=\"1\" />\r\n      </envs>\r\n      <option name=\"SDK_HOME\" value=\"\" />\r\n      <option name=\"WORKING_DIRECTORY\" value=\"$PROJECT_DIR$\" />\r\n      <option name=\"IS_MODULE_SDK\" value=\"true\" />\r\n      <option name=\"ADD_CONTENT_ROOTS\" value=\"true\" />\r\n      <option name=\"ADD_SOURCE_ROOTS\" value=\"true\" />\r\n      <option name=\"SCRIPT_NAME\" value=\"D:\\Projects\\PyCharmProjects\\day69-blog-with-users\\MyBlog\\model.py\" />\r\n      <option name=\"PARAMETERS\" value=\"\" />\r\n      <option name=\"SHOW_COMMAND_LINE\" value=\"false\" />\r\n      <option name=\"EMULATE_TERMINAL\" value=\"false\" />\r\n      <option name=\"MODULE_MODE\" value=\"false\" />\r\n      <option name=\"REDIRECT_INPUT\" value=\"false\" />\r\n      <option name=\"INPUT_FILE\" value=\"\" />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <recent_temporary>\r\n      <list>\r\n        <item itemvalue=\"Python.model\" />\r\n        <item itemvalue=\"Python.login-module\" />\r\n      </list>\r\n    </recent_temporary>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"408a33fc-514c-4f9c-b12a-a0bb1a9e9ae5\" name=\"Changes\" comment=\"\" />\r\n      <created>1655114513929</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1655114513929</updated>\r\n    </task>\r\n    <servers />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State />\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n  </component>\r\n  <component name=\"XDebuggerManager\">\r\n    <breakpoint-manager>\r\n      <breakpoints>\r\n        <line-breakpoint enabled=\"true\" suspend=\"THREAD\" type=\"python-line\">\r\n          <url>file://$PROJECT_DIR$/MyBlog/main.py</url>\r\n          <line>140</line>\r\n          <option name=\"timeStamp\" value=\"3\" />\r\n        </line-breakpoint>\r\n        <line-breakpoint enabled=\"true\" suspend=\"THREAD\" type=\"python-line\">\r\n          <url>file://$PROJECT_DIR$/MyBlog/main.py</url>\r\n          <line>41</line>\r\n          <option name=\"timeStamp\" value=\"4\" />\r\n        </line-breakpoint>\r\n        <line-breakpoint enabled=\"true\" suspend=\"THREAD\" type=\"python-line\">\r\n          <url>file://$PROJECT_DIR$/MyBlog/main.py</url>\r\n          <line>85</line>\r\n          <option name=\"timeStamp\" value=\"5\" />\r\n        </line-breakpoint>\r\n      </breakpoints>\r\n    </breakpoint-manager>\r\n    <watches-manager>\r\n      <configuration name=\"PythonConfigurationType\">\r\n        <watch expression=\"new_post_form.img_url\" />\r\n        <watch expression=\"new_post_form.title.data\" />\r\n        <watch expression=\"email\" />\r\n        <watch expression=\"user.password\" />\r\n        <watch expression=\"request.form.get('password')\" />\r\n      </configuration>\r\n    </watches-manager>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision 498f31eb08934d0124b977673945a265eedbdf9e)
+++ b/.idea/workspace.xml	(date 1655587790348)
@@ -1,7 +1,9 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
   <component name="ChangeListManager">
-    <list default="true" id="408a33fc-514c-4f9c-b12a-a0bb1a9e9ae5" name="Changes" comment="initial working version" />
+    <list default="true" id="408a33fc-514c-4f9c-b12a-a0bb1a9e9ae5" name="Changes" comment="First Version">
+      <change beforePath="$PROJECT_DIR$/main.py" beforeDir="false" afterPath="$PROJECT_DIR$/main.py" afterDir="false" />
+    </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
     <option name="HIGHLIGHT_NON_ACTIVE_CHANGELIST" value="false" />
@@ -117,6 +119,14 @@
       <option name="presentableId" value="Default" />
       <updated>1655114513929</updated>
     </task>
+    <task id="LOCAL-00001" summary="First Version">
+      <created>1655586881883</created>
+      <option name="number" value="00001" />
+      <option name="presentableId" value="LOCAL-00001" />
+      <option name="project" value="LOCAL" />
+      <updated>1655586881883</updated>
+    </task>
+    <option name="localTasksCounter" value="2" />
     <servers />
   </component>
   <component name="Vcs.Log.Tabs.Properties">
@@ -129,6 +139,10 @@
         </entry>
       </map>
     </option>
+  </component>
+  <component name="VcsManagerConfiguration">
+    <MESSAGE value="First Version" />
+    <option name="LAST_COMMIT_MESSAGE" value="First Version" />
   </component>
   <component name="XDebuggerManager">
     <breakpoint-manager>
